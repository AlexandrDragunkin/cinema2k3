# Cinema часть 1

*Разбор правил формирования атрибутов трансформации элементов конструкции для имитации открывания/закрывания дверок, ящиков и т.п.*

Документация на функционал расположена на страничке Динамическая визуализация *(макро)* [wiki](https://bit.ly/3XzZ1Kd))

## Не самый простой случай с линейным перемещением

Судя по документации, что бы получить правильный результат трансформации надо:

присвоить группе или можно её назвать основному объекту (BOSS) два атрибута $CinemaScr, $CinAsseGr
Внутри группы, подчиненным объектам, присвоить атрибуты $CinemaAssembly с указанием типов (управляющая, зависимая, фиксированная) точек с какими то там координатами.
Создадим примитивный поршень, который будет совершать поступательное и возвратное движение. Примерно такой, как изображен на рисунке.

![Рис.1](./pictures/cin_1_1.jpg)

### Создание управляющего объекта

Соберем в группу прямоугольник со штоком. Это будет Управляющий объект. с управляющей точкой с координатами 0, 40, -20. Присвоим этой группе (поршень со штоком) атрибут $CinemaAssembly и $CinemaScr Поскольку это управляющий объект, а именно этот тип объекта задаёт движение всех зависимых.

Создадим Управляющий объект Поршень со штокомИспользуем меню `К3/Структ.оп./Группа/Создать`Или через командную строку набираем на клавиатуре:`group` указываем шток и прямоугольник и жмем правую кнопку мыши выбираем `закончить`.
Присвоим ему атрибуты `$CinemaAssembly` и `$CinemaScr`

![Рис.2](./pictures/cin_1_2.jpg)

Поскольку, это *управляющий объект*, то значения атрибутов у него особенные. Для `$CinemaAssembly` используем второй вариант записи (См.документацию)

Если на объекте есть атрибуты `$CinemaAssembly` и `$CinemaScr`, значит этот объект является управляющим, и в его атрибуте `$CinemaAssembly` записаны координаты управляющей точки. т.е. положение этого объекта (и управляющей точки) рассчитывается командой cinema, и потом передаётся в решатель, для определения положения зависимых объектов.

    1, -1 - зарезервированные значения
    x, y, z - координаты управляющей точки

    1, -1, x, y, z

### Структура атрибута

В нашем случае `$CinemaAssembly` получается 1,-1,0,40,-20

Второй атрибут уже текстовый. Это так называемый Scrath. Что это такое можно почитать на страничке документации.
`$CinemaScr` сложнее и проще одновременно.

Шапка у него стандартная Scratch

Далее имя секции Main

    LocalKey - Признак, нужно ли применять преобразование у подчиненного объекта: 1-нужно
    Control - Подчиненность объекта: 1 - подчиненный (берет информацию о движении от «босса»)
    Beg_time - Общее время начала движения
    Fin_time - Общее время окончания движения
    MoveCount - Количество движений: поворотов и перемещений.

![Рис.3](./pictures/cin_1_3.jpg)
---

## Создание карусели

Соберем для наглядности 1 окружность и 1 линию в группу и назовем это рычаг. Получим два рычага. Третий элемент будет неподвижным.

### Для 2-х рычагов определяем `$CinemaAssembly`

#### Пример для первого рычага:
2, 1, 0, 20, 0, 2, 0, 30, 40


#### Пример для второго рычага:
2, 0, 0, 40, -20, 2, 0, 30, 40


Заметно, что у них есть одна общая зависимая точка: `0,30,40`.

---

## Структура сцены

Все элементы (поршень, два рычага и третий неподвижный) собираем в группу и назначаем этой группе атрибуты `$CinemaScr`, `$CinAsseGr`.

Пример содержимого `$CinemaScr`:
Scratch
MainControl=2
Beg_Time=0
Fin_Time=10
Dir_Time=1
MoveCount=1
Move0LocalKey=1
MoveBeg=0
MoveEnd=10
MoveType=0
MoveX=0
MoveY=25
MoveZ=0


Это описывает задание решателю: сдвинуть управляющую точку на 25 мм по оси Y.

---

## Визуализация

На картинке показаны:
- Исходный момент сдвига.
- Финальный момент сдвига.

Таким образом можно создать анимацию движения поршня и карусели.