# Cinema часть 1

## Разбор правил формирования атрибутов трансформации элементов конструкции

Для имитации открывания/закрывания дверок, ящиков и т.п. в K3, используются специальные атрибуты.

Документация по функционалу находится на странице [**Динамическая визуализация (макро)**](https://bit.ly/3XzZ1Kd) в Wiki.

---

## Не самый простой случай с линейным перемещением

Судя по документации, чтобы получить правильный результат трансформации, необходимо:

1. Присвоить группе (или можно назвать основному объекту — BOSS) два атрибута: `$CinemaScr` и `$CinAsseGr`.
2. Внутри группы, подчиненным объектам, присвоить атрибут `$CinemaAssembly` с указанием типов точек и их координат.

---

## Пример: Поршень

Создадим примитивный поршень, который будет совершать поступательное и возвратное движение.

![Рис.1](.\pictures\cin_1_1.jpg)

### Создание управляющего объекта

- Соберем в группу прямоугольник со штоком. Это будет **управляющий объект**.
- Управляющая точка имеет координаты: `0, 40, -20`.
- Присвоим группе (поршень со штоком) атрибуты `$CinemaAssembly` и `$CinemaScr`.

#### Структура атрибута `$CinemaAssembly` для управляющего объекта:
1, -1, 0, 40, -20

- `1, -1` — зарезервированные значения.
- `x, y, z` — координаты управляющей точки.

#### Атрибут `$CinemaScr`:
Это текстовый атрибут. Структура:
Scratch
MainLocalKey=1
Control=1
Beg_time=0
Fin_time=10
Dir_Time=1
MoveCount=1
Move0LocalKey=1
MoveBeg=0
MoveEnd=10
MoveType=0
MoveX=0
MoveY=25
MoveZ=0


- `MainLocalKey=1` — признак необходимости применять преобразование.
- `Control=1` — подчиненность объекта (берет информацию от «босса»).
- `Beg_time` и `Fin_time` — общее время начала и окончания движения.
- `MoveCount=1` — количество движений.
- `MoveType=0` — тип движения (линейное).
- `MoveY=25` — сдвиг управляющей точки на 25 мм по оси Y.

---

## Создание карусели

Соберем для наглядности 1 окружность и 1 линию в группу и назовем это рычаг. Получим два рычага. Третий элемент будет неподвижным.

### Для 2-х рычагов определяем `$CinemaAssembly`

#### Пример для первого рычага:
2, 1, 0, 20, 0, 2, 0, 30, 40


#### Пример для второго рычага:
2, 0, 0, 40, -20, 2, 0, 30, 40


Заметно, что у них есть одна общая зависимая точка: `0,30,40`.

---

## Структура сцены

Все элементы (поршень, два рычага и третий неподвижный) собираем в группу и назначаем этой группе атрибуты `$CinemaScr`, `$CinAsseGr`.

Пример содержимого `$CinemaScr`:
Scratch
MainControl=2
Beg_Time=0
Fin_Time=10
Dir_Time=1
MoveCount=1
Move0LocalKey=1
MoveBeg=0
MoveEnd=10
MoveType=0
MoveX=0
MoveY=25
MoveZ=0


Это описывает задание решателю: сдвинуть управляющую точку на 25 мм по оси Y.

---

## Визуализация

На картинке показаны:
- Исходный момент сдвига.
- Финальный момент сдвига.

Таким образом можно создать анимацию движения поршня и карусели.